# 🎯 WPR 4.5達成のための科学的トレーニング貯金システム：要件定義 v2

## 🔬 科学的根拠に基づくシステム概要

本システムは、**WPR (Power-to-Weight Ratio) 4.5** を最優先目標とし、エビデンスベースの科学的指標を統合した次世代トレーニング貯金システムです。各指標が相互に連動し、最終的にWPR向上に貢献する設計思想を採用します。

### 🎯 最優先目標
- **WPR 4.5** (体重の4.5倍のFTP) を100日で達成
- **統合アプローチ**: 体重最適化 + FTP向上の両面戦略
- **科学的エビデンス**: Seiler, Krzysztofik, Hopker等の研究成果を実装

---

## 📊 科学的指標システム

### 1. Efficiency Factor (EF) 追跡システム

**目標**: EF 1.2 → 1.5 (25%向上)

**科学的根拠**:
- Hopker et al. (2010): EF向上 = 有酸素フィットネス改善
- TrainingPeaks: "同心拍数でより高パワー維持可能"

**要件**:
- EF = Normalized Power ÷ 平均心拍数 で算出
- WPRへの寄与度: **25%**
- 週次トレンド分析とボトルネック検出
- マイルストーン: +0.05, +0.10, +0.15, +0.20, +0.30

**カウント条件**:
- 20分以上の定常状態ライド
- 心拍数とパワーデータが両方記録済み
- ワームアップ・クールダウンを除外した解析

### 2. Power Profile 統合管理

**目標**: 全時間域で15%向上 (5秒/1分/5分/20分/60分)

**科学的根拠**:
- Cesanelli et al. (2021): S&Cプログラムでパワープロファイル有意改善
- Seiler理論: 多時点パワー能力がFTP基盤となる

**要件**:
- 5秒パワー (神経筋), 1分 (VO2max), 5分 (VO2max持久), 20分 (FTP), 60分 (有酸素持久)
- WPRへの寄与度: **30%**
- 各領域の改善スコア統合計算
- ベースライン比較による進捗定量化

**測定条件**:
- 月1回の定期テスト実施
- 十分な回復状態での測定
- 環境条件の標準化

### 3. HR at Power 効率追跡

**目標**: 固定ワット時の心拍数 -15 bpm

**科学的根拠**:
- Lunn et al. (2009): 循環器適応による同負荷時HR低下
- "内的負荷軽減 = WPR向上への基盤"

**要件**:
- 200W, 250W, 300W 固定での1分間心拍測定
- WPRへの寄与度: **15%**
- 週次測定による効率改善追跡
- 心拍変動による回復度評価

### 4. Volume Load 筋力貯金システム

**目標**: 月間VL 30%向上 (Push/Pull/Legs)

**科学的根拠**:
- Krzysztofik et al. (2019): 週28-30セット/筋群で筋肥大最大化
- Vikmoen et al. (2021): 筋トレで45分平均パワー8%向上

**要件**:
- Volume Load = 重量 × レップ × セット で定量化
- WPRへの寄与度: **20%**
- 部位別 (Push/Pull/Legs) の個別管理
- 月次リセット with 累積記録保持

**カウント条件**:
- 筋群自動判定 (ベンチプレス→Push, 懸垂→Pull等)
- 重量・レップ・セット数の完全記録
- RPE/RIR による質的評価併用

### 5. ROM 可動域最適化システム

**目標**: 各関節可動域 +15° (パワーロス削減)

**科学的根拠**:
- Holliday et al. (2021): 柔軟性とパワー出力の有意相関
- Konrad (2024): 2週間以上のストレッチでROM有意改善

**要件**:
- 前屈角度, 股関節柔軟性, 肩可動域の度数測定
- WPRへの寄与度: **10%**
- パワーロス削減率の定量化
- 動的柔軟性テスト併用

---

## 🧮 多変量最適化アルゴリズム

### 重み付け進捗スコア計算
```
進捗スコア = Σ(正規化指標改善率 × 寄与度係数)
- EF改善 × 0.25
- PowerProfile改善 × 0.30  
- HR効率改善 × 0.15
- VL改善 × 0.20
- ROM改善 × 0.10
```

### ボトルネック検出システム
- 各指標のZスコア算出
- 最低Zスコア = 現在のボトルネック
- AI推薦による重点改善提案

### WPR予測モデル
- 現在の改善率から100日後のWPR予測
- 各指標の寄与度による感度分析
- 目標達成までの残日数算出

---

## 🎮 統合ダッシュボード仕様

### WPR中央ダッシュボード
```
     ┌─────────────────────┐
     │ WPR: 3.2 → 4.5     │
     │ 進捗: 64%          │
     │ 残り: 45日         │
     └─────────────────────┘
          ↗    ↑    ↖
    EF+0.08  FTP+25W  -1.2kg
   (寄与25%) (寄与40%) (寄与35%)
       ↑       ↑        ↑
   HR効率↑   筋力VL↑   ROM改善
  [-8bpm]   [+18%]    [+12°]
```

### 科学的マイルストーンバッジ
- **EF改善バッジ**: +0.05, +0.10, +0.15達成
- **パワープロファイルバッジ**: 各領域10%, 20%, 30%向上
- **心肺効率バッジ**: HR@Power -5, -10, -15 bpm
- **筋力バッジ**: VL月間15%, 30%, 50%増
- **柔軟性バッジ**: ROM +5°, +10°, +15°向上
- **WPR総合バッジ**: 3.5, 4.0, 4.5達成

---

## 🔄 システム統合要件

### 既存システムとの連携
- **WorkoutRecord**: 科学的解析データ自動抽出
- **FTPHistory**: WPR分子 (FTP) 管理
- **DailyMetric**: WPR分母 (体重) 追跡
- **Achievement**: 科学的マイルストーン統合

### AI分析統合
- **WeeklyPlanManager**: ボトルネック基準の最適プラン提案
- **ProgressAnalyzer**: 科学指標トレンド分析
- **予測モデル**: WPR到達確率とリスク評価

---

## 📈 成功指標 (KPI)

### 定量的目標
- **WPR達成率**: 100日で3.0→4.5 (50%向上)
- **指標改善率**: EF +25%, PowerProfile +15%, VL +30%
- **予測精度**: WPR到達予測誤差 ±10日以内

### ユーザーエンゲージメント
- **科学的理解度**: 各指標の意味理解率 90%以上
- **継続率**: 100日プログラム完走率 70%以上
- **満足度**: 科学的アプローチへの満足度 4.5/5以上

---

## 🔧 技術要件

### データモデル設計
```swift
@Model
final class WPRTrackingSystem {
    var currentWPR: Double
    var targetWPR: Double = 4.5
    
    // 科学的指標と係数
    var efficiencyFactor: Double
    var efficiencyCoefficient: Double = 0.25
    
    var powerProfile: PowerProfile?
    var powerProfileCoefficient: Double = 0.30
    
    var hrEfficiencyCoefficient: Double = 0.15
    var strengthCoefficient: Double = 0.20
    var flexibilityCoefficient: Double = 0.10
    
    // アルゴリズム結果
    var overallProgressScore: Double
    var currentBottleneck: BottleneckType?
    var projectedWPRGain: Double
    var daysToTarget: Int?
}
```

### 拡張性設計
- **新指標追加**: Critical Power, HRV, Neuromuscular Fatigue対応
- **係数調整**: 実データによる寄与度動的調整
- **個人最適化**: ユーザー特性による重み付け調整

---

## 🚀 実装段階

### Phase 1: コアシステム (3日)
1. WPRTrackingSystem データモデル実装
2. 科学的指標計算エンジン構築
3. ボトルネック検出アルゴリズム実装

### Phase 2: 最適化エンジン (3日)
1. 多変量重み付けスコア計算
2. WPR予測モデル構築
3. AI推薦システム統合

### Phase 3: ダッシュボード (3日)
1. WPR中央ダッシュボード実装
2. 科学指標可視化コンポーネント
3. ボトルネック分析UI

### Phase 4: システム統合 (2日)
1. 既存システムとの連携
2. 科学的マイルストーン統合
3. 最終調整とテスト

---

## 🔬 エビデンスベース検証

このシステムは以下の科学的研究に基づいて設計されています：

1. **Seiler & Tønnessen (2009)**: 閾値トレーニング最適頻度
2. **Krzysztofik et al. (2019)**: 筋肥大のための最適ボリューム
3. **Hopker et al. (2010)**: サイクリング効率と体重の関係
4. **Vikmoen et al. (2021)**: 筋トレによるパワー向上
5. **Holliday et al. (2021)**: 柔軟性とパワー出力の相関

各指標の寄与度係数は、これらの研究結果と実データ解析により最適化されます。

---

この要件定義により、単なる「回数貯金」から「科学的根拠に基づくWPR最適化システム」へと進化し、100日でWPR 4.5達成という明確な目標に向けた効果的なトレーニング管理が実現されます。