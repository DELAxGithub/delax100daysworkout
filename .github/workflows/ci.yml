name: 🚀 Main CI Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]
  workflow_dispatch:

jobs:
  build:
    name: 🏗️ Build & Compile
    uses: ./.github/workflows/build.yml
    
  test:
    name: 🧪 Automated Tests
    uses: ./.github/workflows/test.yml
    needs: build
    
  quality:
    name: 🛡️ Quality Gates  
    uses: ./.github/workflows/quality.yml
    needs: build
    
  performance:
    name: ⚡ Performance Check
    uses: ./.github/workflows/performance.yml
    needs: build
    
  summary:
    name: 📊 Pipeline Summary
    runs-on: macos-14
    needs: [build, test, quality, performance]
    if: always()
    
    steps:
    - name: 📋 Generate Report
      run: |
        echo "# 🚀 CI/CD Pipeline Results" >> $GITHUB_STEP_SUMMARY
        echo "## Issue #76: Build Pipeline Enhancement" >> $GITHUB_STEP_SUMMARY
        echo "- **Build**: ${{ needs.build.result }}" >> $GITHUB_STEP_SUMMARY
        echo "- **Tests**: ${{ needs.test.result }}" >> $GITHUB_STEP_SUMMARY
        echo "- **Quality**: ${{ needs.quality.result }}" >> $GITHUB_STEP_SUMMARY
        echo "- **Performance**: ${{ needs.performance.result }}" >> $GITHUB_STEP_SUMMARY
        echo "## 🎯 Enterprise-Grade CI/CD Successfully Deployed!" >> $GITHUB_STEP_SUMMARY